"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),t=require("react-dom"),n=require("framer-motion"),o=require("@react-aria/utils");function r(){return(r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function i(e,t){if(null==e)return{};var n={};for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){if(t.indexOf(o)>=0)continue;n[o]=e[o]}return n}var a="calc(100% - env(safe-area-inset-top) - 34px)",s="undefined"==typeof window,l={ease:"easeOut",duration:.2},c={ease:"linear",duration:.01};function d(e,t){for(var n=e[0],o=Math.abs(e[0]-t),r=1;r<e.length;r++){var i=Math.abs(e[r]-t);i<o&&(n=e[r],o=i)}return n}function u(e){var t=document.querySelector("body"),n=document.getElementById(e);n&&(n.style.removeProperty("border-top-right-radius"),n.style.removeProperty("border-top-left-radius"),n.style.removeProperty("transform"),n.addEventListener("transitionend",(function e(){n.style.removeProperty("overflow"),n.style.removeProperty("will-change"),n.style.removeProperty("transition"),t.style.removeProperty("background-color"),n.removeEventListener("transitionend",e)})))}function f(e){var t=e.snapTo,n=e.sheetHeight;return t<0&&console.warn("Snap point is out of bounds. Sheet height is "+n+" but snap point is "+(n+Math.abs(t))+"."),Math.max(Math.round(t),0)}var m=s?e.useEffect:e.useLayoutEffect;function p(t){var n=e.useRef();return e.useEffect((function(){n.current=t})),n.current}function h(t){var n=e.useRef();return m((function(){n.current=t})),e.useCallback((function(){for(var e=n.current,t=arguments.length,o=new Array(t),r=0;r<t;r++)o[r]=arguments[r];return null==e?void 0:e.apply(void 0,o)}),[])}var v=e.createContext(void 0),g=function(){var t=e.useContext(v);if(!t)throw Error("Sheet context error");return t},y=e.createContext(void 0);function b(t){var n=t.children,o=g(),r=e.useState(!!o.disableDrag),i=r[0],a=r[1];return e.createElement(y.Provider,{value:{disableDrag:i,setDragEnabled:function(){o.disableDrag||a(!1)},setDragDisabled:function(){i||a(!0)}}},n)}var w,E=function(){var t=e.useContext(y);if(!t)throw Error("Sheet scroller context error");return t},x="undefined"!=typeof window&&window.visualViewport,C=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]),O=0;function S(e,t,n){var o=e.style[t];return e.style[t]=n,function(){e.style[t]=o}}function T(e,t,n,o){return e.addEventListener(t,n,o),function(){e.removeEventListener(t,n,o)}}function R(e){for(var t=document.scrollingElement||document.documentElement;e&&e!==t;){var n=o.getScrollParent(e);if(n!==document.documentElement&&n!==document.body&&n!==e){var r=n.getBoundingClientRect().top,i=e.getBoundingClientRect().top;i>r+e.clientHeight&&(n.scrollTop+=i-r)}e=n.parentElement}}function P(e){return e instanceof HTMLInputElement&&!C.has(e.type)||e instanceof HTMLTextAreaElement||e instanceof HTMLElement&&e.isContentEditable}var D={wrapper:{position:"fixed",top:0,bottom:0,left:0,right:0,overflow:"hidden",pointerEvents:"none"},backdrop:{zIndex:1,position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0, 0, 0, 0.2)",touchAction:"none",border:"none"},container:{zIndex:2,position:"absolute",left:0,bottom:0,width:"100%",backgroundColor:"#fff",borderTopRightRadius:"8px",borderTopLeftRadius:"8px",boxShadow:"0px -2px 16px rgba(0, 0, 0, 0.3)",display:"flex",flexDirection:"column",pointerEvents:"auto"},headerWrapper:{width:"100%"},header:{height:"40px",width:"100%",position:"relative",display:"flex",alignItems:"center",justifyContent:"center"},indicator:{width:"18px",height:"4px",borderRadius:"99px",backgroundColor:"#ddd"},content:{flexGrow:1,display:"flex",flexDirection:"column",minHeight:"0px",position:"relative"},scroller:{height:"100%",overflowY:"auto"}},M=["onOpenStart","onOpenEnd","onClose","onCloseStart","onCloseEnd","onSnap","children","isOpen","snapPoints","rootId","mountPoint","style","detent","initialSnap","disableDrag","prefersReducedMotion","tweenConfig","dragVelocityThreshold","dragCloseThreshold"],H=e.forwardRef((function(a,g){var y=a.onOpenStart,E=a.onOpenEnd,C=a.onClose,H=a.onCloseStart,k=a.onCloseEnd,N=a.onSnap,L=a.children,j=a.isOpen,A=a.snapPoints,q=a.rootId,I=a.mountPoint,B=a.style,Y=a.detent,z=void 0===Y?"full-height":Y,V=a.initialSnap,W=void 0===V?0:V,F=a.disableDrag,X=void 0!==F&&F,_=a.prefersReducedMotion,G=void 0!==_&&_,J=a.tweenConfig,K=void 0===J?l:J,Q=a.dragVelocityThreshold,U=void 0===Q?500:Q,Z=a.dragCloseThreshold,$=void 0===Z?.6:Z,ee=i(a,M),te=e.useRef(null),ne=n.useMotionValue(0),oe=function(){var t=e.useState(0),n=t[0],o=t[1];return m((function(){var e=function(){return o(window.innerHeight)};return window.addEventListener("resize",e),e(),function(){return window.removeEventListener("resize",e)}}),[]),n}(),re=n.useReducedMotion(),ie=Boolean(G||re),ae=r({type:"tween"},ie?c:K),se=n.useMotionValue(0),le=n.useTransform(se,(function(e){return e>=oe?-1:9999999})),ce=n.useTransform(se,(function(e){return e>=oe?"hidden":"visible"})),de=e.useRef({onOpenStart:y,onOpenEnd:E,onCloseStart:H,onCloseEnd:k});m((function(){de.current={onOpenStart:y,onOpenEnd:E,onCloseStart:H,onCloseEnd:k}})),A&&(A=A.map((function(e){return e>0&&e<=1?Math.round(e*oe):e<0?oe+e:e})),console.assert(function(e){for(var t=0;t<e.length;t++)if(e[t+1]>e[t])return!1;return!0}(A)||0===oe,"Snap points need to be in descending order got: ["+A+"]"));var ue=h((function(e,t){var n=t.delta,o=se.getVelocity();o>0&&ne.set(10),o<0&&ne.set(-10),se.set(Math.max(se.get()+n.y,0))})),fe=h((function(e,t){if(t.velocity.y>U)C();else{var o=te.current.getBoundingClientRect().height,r=se.get(),i=0;if(A){var a=A.map((function(e){return o-Math.min(e,o)}));"content-height"!==z||a.includes(0)||a.unshift(0),i=d(a,r)}else r/o>$&&(i=o);if(i=f({snapTo:i,sheetHeight:o}),n.animate(se,i,ae),A&&N){var s=Math.abs(Math.round(A[0]-i)),l=A.indexOf(d(A,s));N(l)}i>=Math.round(o)&&C()}ne.set(0)}));e.useEffect((function(){A&&N&&N(j?W:A.length-1)}),[j]),e.useImperativeHandle(g,(function(){return{y:se,snapTo:function(e){var t=te.current;if(A&&void 0!==A[e]&&null!==t){var o=t.getBoundingClientRect().height,r=f({snapTo:o-A[e],sheetHeight:o});n.animate(se,r,ae),N&&N(e),r>=o&&C()}}}})),function(t,n){var o=p(t);e.useEffect((function(){n&&!o&&t?function(e){var t=document.querySelector("body"),n=document.querySelector("#"+e);if(n){var o=window.innerHeight,r=(o-24)/o;t.style.backgroundColor="#000",n.style.overflow="hidden",n.style.willChange="transform",n.style.transition="transform 200ms ease-in-out, border-radius 200ms linear",n.style.transform="translateY(calc(env(safe-area-inset-top) + 12px)) scale("+r+")",n.style.borderTopRightRadius="10px",n.style.borderTopLeftRadius="10px"}}(n):n&&!t&&o&&u(n)}),[t,o]),e.useEffect((function(){return function(){n&&t&&u(n)}}),[t])}(j,q),function(e){void 0===e&&(e={});var t=e.isDisabled;o.useLayoutEffect((function(){if(!t)return 1==++O&&(w=o.isIOS()?function(){var e,t=0,n=window.pageXOffset,r=window.pageYOffset,i=o.chain(S(document.documentElement,"paddingRight",window.innerWidth-document.documentElement.clientWidth+"px"),S(document.documentElement,"overflow","hidden"),S(document.body,"marginTop","-"+r+"px"));window.scrollTo(0,0);var a=o.chain(T(document,"touchstart",(function(n){(e=o.getScrollParent(n.target))===document.documentElement&&e===document.body||(t=n.changedTouches[0].pageY)}),{passive:!1,capture:!0}),T(document,"touchmove",(function(n){if(e!==document.documentElement&&e!==document.body){var o=n.changedTouches[0].pageY,r=e.scrollTop,i=e.scrollHeight-e.clientHeight;0!==i&&((r<=0&&o>t||r>=i&&o<t)&&n.preventDefault(),t=o)}else n.preventDefault()}),{passive:!1,capture:!0}),T(document,"touchend",(function(e){var t=e.target;P(t)&&t!==document.activeElement&&(e.preventDefault(),t.style.transform="translateY(-2000px)",t.focus(),requestAnimationFrame((function(){t.style.transform=""})))}),{passive:!1,capture:!0}),T(document,"focus",(function(e){var t=e.target;P(t)&&(t.style.transform="translateY(-2000px)",requestAnimationFrame((function(){t.style.transform="",x&&(x.height<window.innerHeight?requestAnimationFrame((function(){R(t)})):x.addEventListener("resize",(function(){return R(t)}),{once:!0}))})))}),!0),T(window,"scroll",(function(){window.scrollTo(0,0)})));return function(){i(),a(),window.scrollTo(n,r)}}():o.chain(S(document.documentElement,"paddingRight",window.innerWidth-document.documentElement.clientWidth+"px"),S(document.documentElement,"overflow","hidden"))),function(){0==--O&&w()}}),[t])}({isDisabled:!j});var me=e.useMemo((function(){return X?void 0:{drag:"y",dragElastic:0,dragConstraints:{top:0,bottom:0},dragMomentum:!1,dragPropagation:!1,onDrag:ue,onDragEnd:fe}}),[X]),pe=e.createElement(v.Provider,{value:{y:se,sheetRef:te,isOpen:j,initialSnap:W,snapPoints:A,detent:z,indicatorRotation:ne,callbacks:de,dragProps:me,windowHeight:oe,animationOptions:ae,reduceMotion:ie,disableDrag:X}},e.createElement(n.motion.div,Object.assign({},ee,{ref:g,style:r({},D.wrapper,{zIndex:le,visibility:ce},B)}),e.createElement(n.AnimatePresence,null,j?e.createElement(b,null,e.Children.map(L,(function(t,n){return e.cloneElement(t,{key:"sheet-child-"+n})}))):null)));return s?pe:t.createPortal(pe,null!=I?I:document.body)})),k=["children","style","className"],N=e.forwardRef((function(t,o){var s,l=t.children,c=t.style,d=void 0===c?{}:c,u=t.className,f=void 0===u?"":u,m=i(t,k),h=g(),v=h.y,y=h.snapPoints,b=h.initialSnap,w=void 0===b?0:b,E=h.sheetRef,x=h.windowHeight,C=h.detent,O=h.animationOptions,S=h.reduceMotion,T=function(t,n){var o=p(t),r=e.useRef(!1),i=e.useCallback((function(){r.current?(null==n.current.onCloseEnd||n.current.onCloseEnd(),r.current=!1):(null==n.current.onOpenEnd||n.current.onOpenEnd(),r.current=!0)}),[t,o]);return e.useEffect((function(){!o&&t?null==n.current.onOpenStart||n.current.onOpenStart():!t&&o&&(null==n.current.onCloseStart||n.current.onCloseStart())}),[t,o]),{handleAnimationComplete:i}}(h.isOpen,h.callbacks).handleAnimationComplete,R=y?y[0]-y[w]:0,P=y?y[0]:null,M=null!==P?"min("+P+"px, "+a+")":a;return e.createElement(n.motion.div,Object.assign({},m,{ref:(s=[E,o],function(e){s.forEach((function(t){"function"==typeof t?t(e):t&&(t.current=e)}))}),className:"react-modal-sheet-container "+f,style:r({},D.container,d,"full-height"===C&&{height:M},"content-height"===C&&{maxHeight:M},{y:v}),initial:!S&&{y:x},animate:{y:R,transition:O},exit:{y:x,transition:O},onAnimationComplete:T}),l)})),L=["children","style","disableDrag","className"],j=e.forwardRef((function(t,o){var a=t.children,s=t.style,l=t.disableDrag,c=t.className,d=void 0===c?"":c,u=i(t,L),f=g(),m=E(),p=l||m.disableDrag?void 0:f.dragProps;return e.createElement(n.motion.div,Object.assign({},u,{ref:o,className:"react-modal-sheet-content "+d,style:r({},D.content,s)},p),a)})),A=["children","style","disableDrag"],q=e.forwardRef((function(t,o){var a=t.children,s=t.style,l=t.disableDrag,c=i(t,A),d=g(),u=d.indicatorRotation,f=l?void 0:d.dragProps,m=n.useTransform(u,(function(e){return"translateX(2px) rotate("+e+"deg)"})),p=n.useTransform(u,(function(e){return"translateX(-2px) rotate("+-1*e+"deg)"}));return e.createElement(n.motion.div,Object.assign({},c,{ref:o,style:r({},D.headerWrapper,s)},f),a||e.createElement("div",{className:"react-modal-sheet-header",style:D.header},e.createElement(n.motion.span,{className:"react-modal-sheet-drag-indicator",style:r({},D.indicator,{transform:m})}),e.createElement(n.motion.span,{className:"react-modal-sheet-drag-indicator",style:r({},D.indicator,{transform:p})})))})),I=["style","className"],B=function(e){return!!e.onClick||!!e.onTap},Y=e.forwardRef((function(t,o){var a=t.style,s=void 0===a?{}:a,l=t.className,c=void 0===l?"":l,d=i(t,I),u=B(d)?n.motion.button:n.motion.div,f=B(d)?"auto":"none";return e.createElement(u,Object.assign({},d,{ref:o,className:"react-modal-sheet-backdrop "+c,style:r({},D.backdrop,s,{pointerEvents:f}),initial:{opacity:0},animate:{opacity:1},exit:{opacity:0}}))})),z=["draggableAt","children","style","className"],V=e.forwardRef((function(t,n){var o=t.draggableAt,a=void 0===o?"top":o,s=t.children,l=t.style,c=t.className,d=void 0===c?"":c,u=i(t,z),f=E();function m(e){var t=e.scrollTop,n=e.scrollHeight,o=e.clientHeight;if(n>o){var r=t<=0,i=n-t===o;"top"===a&&r||"bottom"===a&&i||"both"===a&&(r||i)?f.setDragEnabled():f.setDragDisabled()}}var p="undefined"!=typeof window&&("ontouchstart"in window||navigator.maxTouchPoints>0)?{onScroll:function(e){m(e.currentTarget)},onTouchStart:function(e){m(e.currentTarget)}}:void 0;return e.createElement("div",Object.assign({},u,{ref:n,className:"react-modal-sheet-scroller "+d,style:r({},D.scroller,l)},p),s)})),W=H;W.Container=N,W.Header=q,W.Content=j,W.Backdrop=Y,W.Scroller=V,exports.default=W;
//# sourceMappingURL=react-modal-sheet.cjs.production.min.js.map
